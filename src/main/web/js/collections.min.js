var COLUMNS=3;var MODAL_COLLECTION_ADD="modal_collection_add";var currentColumn=0;var apiCollectionsList="/api/v1/collections/list";var apiCollectionsEntries="/api/v1/collections/entries";var apiCollectionAdd="/api/v1/collections/add";var baseFavicoDomain="http://www.google.com/s2/favicons?domain=";var collections={};var collectionsIds=[];var collectionsById={};var collectionTmpl={};var feedEntriesTmpl={};Handlebars.registerHelper("favico",function(a){return baseFavicoDomain});function initCollections(){collectionTmpl=Handlebars.compile($("#collections_tmpl").html());feedEntriesTmpl=Handlebars.compile($("#feeds_tmpl").html());createdTmpl=Handlebars.compile($("#collection_created_tmpl").html());var a={};collectionsIds=[];$.get(baseUrl+apiCollectionsList,a,function(e,d){collections=e.entries;if(e.entries){for(var b=0;b<e.entries.length;b++){var f=e.entries[b];collectionsIds[collectionsIds.length]=f.l_collection_id;collectionsById[f.l_collection_id]=f;console.log(f);console.log("currentColumn "+currentColumn);f.column=currentColumn;$("#col"+currentColumn++).append(collectionTmpl({c:f}));if(currentColumn>=COLUMNS){currentColumn=0}}}else{console.error("no entries found "+e)}})}function toggleFeedsCollection(b,c){var d=$("#feeds_"+c);if(d.is(":visible")){b.text="... show";d.hide()}else{var a={};a.ids=c;b.text="... hide";$.get(baseUrl+apiCollectionsEntries,a,function(f,e){d.html(feedEntriesTmpl({entries:f.entries}));d.show()})}}function showAddModal(b,e){$("#collectionCreated").hide();var c=collectionsById[e];showModal("Add '"+c.s_name+"' collection","#"+MODAL_COLLECTION_ADD,function a(){},function d(){$("#collectionName").val(c.s_name);$("#collectionId").val(e)})}function importCollection(){var d=$("#collectionId").val();var b=$("#collectionName").val();var c=$("#selectedProfiles").val()||[];var a={};a.id=d;a.name=b;a.profiles=c.toString();$.get(baseUrl+apiCollectionAdd,a,function(f,e){if(f.error){modalError(f.error)}else{if(f.success){console.log(f);$("#collectionCreated").html(createdTmpl(f));$("#collectionCreated").show()}else{console.error(f);console.error(e)}}})};