function addSubscribeUrl(a,b){var c={};c.n="",c.sid=b,c.u=$("#"+a).val(),addSubscription(c,function(b){b.success?(showInfoMsg("#add-msg",b.success),$("#"+a).val("")):b.error?showErrorMsg("#add-msg",b.error):showErrorMsg("#add-msg","unknown response: "+JSON.stringify(b))})}function apiFindSource(a,b){$.getJSON(baseUrl+apiSourcesFind,a,function(a){b(a)})}function addSubscription(a,b){$.getJSON(baseUrl+apiUrlSubscriptionsAdd,a,function(a){b(a)})}function toTop(){window.scrollTo(0,0)}function slideInLeft(a,b,c){var d=$(a);d.css("left",d.parent().width()*-1),d.show(),d.animate({left:0},{complete:c,duration:b})}function slideOutLeft(a,b,c){var d=$(a);d.animate({left:d.parent().width()*-1},{complete:c,duration:b})}function switchAngleLr(a,b){var c="right"==b?"left":"right";a.removeClass("fa-angle-"+b).addClass("fa-angle-"+c)}function showEl(a,b){var c=$("#"+b);if(c.is(":visible"))c.hide(),$(document).off("mousedown.el");else{c.width();c.show(),$(document).on("mousedown.el",function(b){$(a).is(b.target)||$(a).has(b.target).length>0||c.is(b.target)||0!=c.has(b.target).length||(c.hide(),$(document).off("mousedown.el"))})}}function addContent(){var a=selectedStream.l_stream_id,b=a?"?to="+a:"";location.href=baseUrl+"/add"+b}function attachColorPicker(a){var b=new jscolor.color(a.get(0),{slider:!0,pickerFaceColor:"transparent",pickerMode:"HSV",pickerFace:1,pickerBorder:0,pickerInsetColor:"black"});b.fromString(a.attr("data-color"))}function closeAnimate(){var a=$(leftMenuId);a.animate({left:a.width()*-1},200,"swing",function(){a.hide()})}function openAnimate(){var a=$(leftMenuId);a.css("left",a.width()*-1),a.show(),a.animate({left:0},200)}function closeLeftBar(){closeProfiles(),closeAnimate(),$(document).off("keyup.leftbar"),$(document).off("mousedown.leftbar"),$(leftMenuId).off("swipeleft")}function openLeftBar(){openAnimate(),$(leftMenuId).is(":visible")&&($(document).on("keyup.leftbar",function(a){27==a.keyCode&&closeLeftBar()}),$(leftMenuId).on("swipeleft",function(){closeLeftBar()}),$(document).on("mousedown.leftbar",function(a){var b=$(leftMenuId);b.is(a.target)||0!==b.has(a.target).length||closeLeftBar()}))}function lmToggleProfiles(){$(profilesId);$(profilesId).toggle()}function closeProfiles(){$(profilesId).hide()}function checkProfileAngle(){var a=$(profilesId),b=$("#header-p-angle");a.is(":visible")?b.removeClass("fa-angle-down").addClass("fa-angle-up"):b.removeClass("fa-angle-up").addClass("fa-angle-down")}function lmShowAddContent(){$(plusIconId).addClass("fa-active"),$(filterIconId).removeClass("fa-active"),$(streamsFilterId).hide(),$(addContentId).toggle(),$(addContentId).is(":visible")?$(plusIconId).addClass("fa-active"):$(plusIconId).removeClass("fa-active")}function lmShowFilters(){$(plusIconId).removeClass("fa-active"),$(addContentId).hide(),$(streamsFilterId).toggle(),$(streamsFilterId).is(":visible")?$(filterIconId).addClass("fa-active"):$(filterIconId).removeClass("fa-active")}function closeMsg(a){$(a).closest(".msg").hide()}function clearMsgElem(a){a.removeClass("msg-error msg-info msg-warning")}function showErrorMsg(a,b){showMsg(a,b,"msg-error")}function showInfoMsg(a,b){showMsg(a,b,"msg-info")}function showMsg(a,b,c){var d=$(a);d.hide(),clearMsgElem(d),d.addClass(c),d.find(".text").html(b),d.show()}function saveStreamGroup(a){var b=$("#"+a);raClearMsg(a);var c={};return c.sn=b.val(),0==b.val().length?void raError(a,"Please enter a name"):void $.get(baseUrl+apiUrlStreamsAdd,c,function(a){a.success?getStreamGroups(function(){loadStream(a.id),closeLeftBar()}):alert(a.error)},"json")}function raClearMsg(a){var b=$("#"+a+"-msg");b.removeClass("msg-error"),b.hide(),b.html("")}function raError(a,b){var c=$("#"+a+"-msg");c.html(b),c.addClass("msg-error"),c.show()}function hideSearch(){var a=$("#header-input"),b=$("#header-content");b.show(),a.addClass("hide"),searched&&(location.href!=lastLocation?window.location.href=lastLocation:location.reload())}function showSearch(a){lastLocation=location.href;var b=$("#header-input"),c=$("#header-content");c.hide(),b.removeClass("hide"),b.show();var d=b.find("input");d.focus()}function search(a){if(a)if(13==a.keyCode){var b={};b.title=$(searchId).val(),apiFindSource(b,function(a){searched=!0,$("#stream-header .content").html(""),$("#stream-entries").html(tmplSourceResult({entries:a.entries}))})}else 27==a.keyCode&&hideSearch()}function settingsError(a){showErrorMsg("#settings-msg",a)}function settingsInfo(a){showErrorMsg("#settings-msg",a)}function loadColorPickers(){$(".profile-row").find("input[data-color]").each(function(a,b){attachColorPicker($(b))})}function forwardSaveProfile(){var a=$("#name_profile_0"),b=$("#picker_profile_0"),c={};c.n=a.val(),c.c=b.val(),$.getJSON(baseUrl+"/api/v1/user/profiles/new",c,function(a){a.success?(settingsInfo("Profile created "+c.n),setSessionProfile(a.profileid,function(){selectProfile(a.profileid),location.reload()})):settingsError("Erorr creating new profile: "+a.error)})}function addNewProfile(){var a=$(Handlebars.partials.tmplprofile({l_profile_id:"0",s_profile_name:"",s_color:"#173C4F"})),b=$('<input type="button" value="Add" onclick="forwardSaveProfile()" />'),c=$(a).find(".actions");c.html(b),$("#profile-list").append($(a)),attachColorPicker($("#picker_profile_0")),disableAddNew(),$("#name_profile_0").focus()}function disableAddNew(){$("#addNewProfile").addClass("disabled").off("click")}function spActivateBurron(a){$(a).attr("disabled",!1)}function saveProfile(a,b){var c=$("#name_profile_"+a).val(),d=$("#picker_profile_"+a).val();$(b).attr("disabled",!0);var e={};e.pid=a,e.n=c,e.c=d,$.getJSON(baseUrl+"/api/v1/user/profiles/save",e,function(a){a.count>0?settingsInfo("Profile saved "+c):($(b).attr("disabled",!1),settingsError("Couldn't save profile"))})}function sourceAdd(){alert("add-source")}function shToggleActions(a){var b=$(a).find("i");b.hasClass("fa-angle-right")?slideInLeft(streamActionsId,500,function(){switchAngleLr(b,"right")}):slideOutLeft(streamActionsId,500,function(){switchAngleLr(b,"left")})}function shToggleSettings(a){var b=$(streamOptionsId);b.toggle(),checkColor(streamOptionsId,streamHeaderAngleId)}function slForwardSaveEntry(a){var b=slGetDataId(a);saveEntry(a,b)}function slLineOptions(a,b){var c=$("#article-"+b).find(".content"),d=$(a).find("i");if(d.hasClass("fa-angle-right")){if(0==$("options-"+b).length){var e=$("#line-view-options-tmpl").clone();e.first().attr("id","options-"+b),e.first().attr("data-id",b),c.append(e)}slideInLeft("#options-"+b,250,function(){switchAngleLr(d,"right")})}else slideOutLeft("#options-"+b,250,function(){switchAngleLr(d,"left")})}function slCloseOptions(a){var b=$(a).closest("div .options"),c=b.attr("data-id"),d=$("#article-"+c);slOutRight("options-"+c,d.width())}function slGetDataId(a){var b=$(a).closest("div .options");return b.attr("data-id")}function changePassword(a,b){$("#password-msg").hide();var c=$(b).find("input[name=pwd1]").val(),d=$(b).find("input[name=pwd2]").val();c!=d?showWarning("Passwords don't match"):""==c?showWarning("Empty password"):$.post(baseUrl+"/wizard",{pwd1:c,pwd2:d,"wizard-step":1},function(b){b.success?($(a).addClass("success"),goNext(!0)):100==b.code?(showWarning(b.error),$("#btn-pwd-change").addClass("success").html("Skip step"),$("#btn-pwd-change").removeAttr("onclick"),$("#btn-pwd-change").on("click",goNext)):showWarning(b.error?b.error:b)}).fail(function(a,b){showWarning(a.statusText)})}function showWarning(a){$("#password-msg").show(),$("#password-msg").addClass("warn-msg").html(a)}function currentStep(){return steps[0]}function goNext(a){if(!running){running=!0;var b=steps[0];steps.splice(0,1),setTimeout(function(){a&&$("#"+welcome).fadeOut(1e3),$("."+b).fadeOut(1e3,function(){$("."+currentStep()).show(),running=!1})},200)}}var apiSourcesFind="/api/v1/sources/find",apiUrlSubscriptionsAdd="/api/v1/user/subscriptions/add";$(document).ready(function(){var a=new Hammer(document);a.get("swipe").set({direction:Hammer.DIRECTION_ALL,pointer:1,treshold:10,velocity:.3}),a.on("swipeleft",function(a){closeLeftBar()}),a.on("swiperight",function(a){openLeftBar()})});var leftMenuId="#left-menu",streamsFilterId="#streams-filter",addContentId="#add-content",filterIconId="#filter-icon",plusIconId="#plus-icon",profilesId="#profiles",searchId="#search",tmplSourceResult={},lastLocation="",searched=!1;$(document).ready(function(){var a=$("#search-sources-result").html();a&&($(searchId).on("keyup",search),tmplSourceResult=Handlebars.compile(a))});var spTmpl=spTmpl||{};$(document).ready(function(){registerOnProfilesAvailable(function(){var a=$("#tmpl-settings-profile").html();a&&(Handlebars.registerPartial("tmplprofile",a),spTmpl=Handlebars.compile($("#tmpl-settings-profile-list").html()),profiles&&($("#profile-list").html(spTmpl({profiles:profiles})),$("#addNewProfile").on("click",addNewProfile)),loadColorPickers())})}),$(document).ready(function(){$(".source-add").on("click",sourceAdd)});var streamActionsId="#stream-actions",streamHeaderAngleId="#stream-header-angle",streamOptionsId="#stream-options",welcome="welcome",steps=["password-setup","thanks"],running=!1;
//# sourceMappingURL=app.min.js.map